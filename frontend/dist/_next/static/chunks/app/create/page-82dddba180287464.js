(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{4094:(e,t,s)=>{"use strict";s.d(t,{LanguageProvider:()=>i,o:()=>o});var r=s(5155),a=s(2115);let n={zh:{appName:"试玩广告制作平台",heroTitle:"试玩广告制作平台",heroDescription:"通过互动式试玩广告提升您的应用营销效果。创建、自定义和部署能够提高转化率的吸引人广告。",startCreatingNow:"立即开始创建",watchDemo:"观看演示",whyChoose:"为什么选择试玩广告制作平台？",whyChooseSubtitle:"为现代应用营销人员设计的专业工具",feature1Title:"拖放式简易操作",feature1Description:"无需编程。上传您的视频并使用我们直观的界面进行自定义。",feature2Title:"多平台支持",feature2Description:"导出适用于Google Ads、Facebook、AppLovin、Unity等多个平台的广告。",feature3Title:"互动元素",feature3Description:"添加暂停帧、号召性用语按钮、横幅和自定义互动。",feature4Title:"实时预览",feature4Description:"通过我们的实时预览系统即时查看您的更改。",feature5Title:"专业模板",feature5Description:"从经过验证的模板开始，或从头创建。",feature6Title:"分析就绪",feature6Description:"内置跟踪和分析功能，用于衡量您的广告效果。",ctaTitle:"准备创建您的第一个试玩广告？",ctaDescription:"加入已经使用试玩广告制作平台提高转化率的数千名应用营销人员的行列。",getStartedFree:"免费开始使用",features:"功能特点",pricing:"价格方案",backToHome:"返回首页",createPlayableAd:"创建试玩广告",uploadVideo:"上传视频",addPauseFrames:"添加暂停帧",addCTAButtons:"添加CTA按钮",addBannersOptional:"添加横幅（可选）",export:"导出",workflowTitle:"工作流程",workflowHeading:"简单三步，创建专业广告",workflowDescription:"无需编程技能，通过直观的拖拽界面，快速创建高质量的互动广告",step1Title:"上传视频",step1Description:"上传您的产品视频，支持多种格式，自动优化压缩",step2Title:"添加互动元素",step2Description:"拖拽添加暂停帧、CTA按钮、横幅等互动元素",step3Title:"导出发布",step3Description:"一键导出多平台格式，直接发布到各大广告平台",platformTitle:"平台支持",platformHeading:"支持主流广告平台",platformDescription:"一次创建，多平台发布，覆盖所有主流广告渠道",statsAdsCreated:"广告创建",statsPlatformsSupported:"平台支持",statsUserSatisfaction:"用户满意度"},en:{appName:"Playable Ads Maker",heroTitle:"Playable Ads Maker",heroDescription:"Transform your app marketing with interactive playable ads. Create, customize, and deploy engaging ads that convert.",startCreatingNow:"Start Creating Now",watchDemo:"Watch Demo",whyChoose:"Why Choose Playable Ads Platform?",whyChooseSubtitle:"Professional tools designed for modern app marketers",feature1Title:"Drag & Drop Simplicity",feature1Description:"No coding required. Upload your video and customize with our intuitive interface.",feature2Title:"Multi-Platform Support",feature2Description:"Export for Google Ads, Facebook, AppLovin, Unity, and more platforms.",feature3Title:"Interactive Elements",feature3Description:"Add pause frames, CTA buttons, banners, and custom interactions.",feature4Title:"Real-time Preview",feature4Description:"See your changes instantly with our live preview system.",feature5Title:"Professional Templates",feature5Description:"Start with proven templates or create from scratch.",feature6Title:"Analytics Ready",feature6Description:"Built-in tracking and analytics to measure your ad performance.",ctaTitle:"Ready to Create Your First Playable Ad?",ctaDescription:"Join thousands of app marketers who are already using Playable Ads Platform to boost their conversion rates.",getStartedFree:"Get Started Free",features:"Features",pricing:"Pricing",backToHome:"Back to Home",createPlayableAd:"Create Playable Ad",uploadVideo:"Upload Video",addPauseFrames:"Add Pause Frames",addCTAButtons:"Add CTA Buttons",addBannersOptional:"Add Banners (Optional)",export:"Export",workflowTitle:"Workflow",workflowHeading:"Create Professional Ads in 3 Simple Steps",workflowDescription:"No programming skills needed. Quickly create high-quality interactive ads with our intuitive drag-and-drop interface",step1Title:"Upload Video",step1Description:"Upload your product video, supporting multiple formats with automatic optimization",step2Title:"Add Interactive Elements",step2Description:"Drag and drop pause frames, CTA buttons, banners and other interactive elements",step3Title:"Export & Publish",step3Description:"One-click export to multiple platform formats, ready to publish on major ad platforms",platformTitle:"Platform Support",platformHeading:"Support for Major Ad Platforms",platformDescription:"Create once, publish everywhere. Cover all mainstream advertising channels",statsAdsCreated:"Ads Created",statsPlatformsSupported:"Platforms Supported",statsUserSatisfaction:"User Satisfaction"}},l=(0,a.createContext)({locale:"zh",setLocale:()=>{},t:e=>e});function o(){return(0,a.useContext)(l)}function i(e){let{children:t}=e,[s,o]=(0,a.useState)("zh"),[i,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{d(!0);try{let e=localStorage.getItem("locale");e&&("zh"===e||"en"===e)&&(o(e),document.documentElement.lang=e)}catch(e){console.error("Failed to access localStorage:",e)}},[]);let c=e=>{o(e);try{localStorage.setItem("locale",e)}catch(e){console.error("Failed to write to localStorage:",e)}document.documentElement.lang=e},u=e=>i?n[s]&&n[s][e]||n.en&&n.en[e]||e:n.zh[e]||e;return i?(0,r.jsx)(l.Provider,{value:{locale:s,setLocale:c,t:u},children:t}):(0,r.jsx)(l.Provider,{value:{locale:"zh",setLocale:c,t:u},children:t})}},5111:(e,t,s)=>{Promise.resolve().then(s.bind(s,5420))},5420:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(5155),a=s(2115),n=s(2619),l=s.n(n);let o=e=>{let{steps:t,currentStep:s}=e;return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:t.map((e,n)=>(0,r.jsxs)(a.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat(e.id===s?"bg-blue-600 text-white":e.id<s?"bg-green-500 text-white":"bg-gray-200 text-gray-600"),children:e.id<s?(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.id}),(0,r.jsx)("span",{className:"text-xs mt-2 ".concat(e.id===s?"text-blue-600 font-medium":"text-gray-500"),children:e.title})]}),n<t.length-1&&(0,r.jsx)("div",{className:"flex-1 mx-2",children:(0,r.jsx)("div",{className:"h-1 ".concat(s>n+1?"bg-green-500":"bg-gray-200")})})]},e.id))})})};var i=s(4054),d=s(5704);d.env.NEXT_PUBLIC_API_BASE_URL,d.env.NEXT_PUBLIC_API_URL;let c={baseUrl:d.env.NEXT_PUBLIC_API_BASE_URL||"https://api.playableadsmaker.com",apiUrl:d.env.NEXT_PUBLIC_API_URL||"https://api.playableadsmaker.com/api"},u={upload:"".concat(c.apiUrl,"/upload"),generate:"".concat(c.apiUrl,"/generate"),download:(e,t)=>"".concat(c.apiUrl,"/download/").concat(e,"/").concat(t),downloadFile:e=>"".concat(c.apiUrl,"/download-file?file_path=").concat(encodeURIComponent(e.replace(/^\//,""))),projectFilesInfo:e=>"".concat(c.apiUrl,"/project-files-info?project_id=").concat(e)},m=e=>e.startsWith("http")?e:"".concat(c.baseUrl).concat(e),x=e=>{var t,s,n,l,o;let{formData:d,updateFormData:c,nextStep:x}=e,[h,p]=(0,a.useState)(!1),[g,f]=(0,a.useState)(0),[v,b]=(0,a.useState)(null),[j,w]=(0,a.useState)(!1),[y,N]=(0,a.useState)(null),k=(0,a.useRef)(null),C=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(d.video&&d.video.metadata){let{width:e,height:t}=d.video.metadata;e&&t&&(w(e>t),console.log("VideoUpload - 视频元数据中的宽高:",{width:e,height:t,isLandscape:e>t,metadata:d.video.metadata}))}},[d.video]),(0,a.useEffect)(()=>{let e=()=>{k.current&&console.log("VideoUpload - 视频元素实际宽高:",{videoWidth:k.current.videoWidth,videoHeight:k.current.videoHeight,duration:k.current.duration,clientWidth:k.current.clientWidth,clientHeight:k.current.clientHeight})};return k.current&&k.current.addEventListener("loadedmetadata",e),()=>{k.current&&k.current.removeEventListener("loadedmetadata",e)}},[]);let L=async e=>{if(0!==e.length){if(!e[0].type.startsWith("video/"))return void b("Please upload a video file");try{b(null),p(!0);let t=setInterval(()=>{f(e=>e>=95?(clearInterval(t),95):e+5)},100),s=new FormData;s.append("file",e[0]),s.append("type","video"),s.append("step","video_upload");let r=await fetch(u.upload,{method:"POST",body:s});if(clearInterval(t),f(100),!r.ok)throw Error("Failed to upload video");let a=await r.json();if(!a.success)throw Error(a.error||"Failed to upload video");a.project_id&&(N(a.project_id),c("project_id",a.project_id)),c("video",{id:a.file_id,url:m(a.url),metadata:a.metadata,name:a.file_id,originalName:e[0].name}),a.metadata&&a.metadata.width&&a.metadata.height&&w(a.metadata.width>a.metadata.height),setTimeout(()=>{p(!1),f(0)},500)}catch(e){b(e instanceof Error?e.message:"An error occurred during upload"),p(!1),f(0)}}},{getRootProps:F,getInputProps:S,isDragActive:B}=(0,i.VB)({onDrop:L,accept:{"video/*":[]},maxFiles:1,disabled:h}),P=()=>{if(k.current){let{videoWidth:e,videoHeight:t}=k.current;w(e>t)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Upload Video"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Upload the video you want to use for your playable ad"})]}),(0,r.jsxs)("div",{...F(),className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(B?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"," ").concat(h?"opacity-75":""),children:[(0,r.jsx)("input",{...S()}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("svg",{className:"mx-auto h-16 w-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 4v16M17 4v16M3 8h18M3 16h18"})}),h?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-gray-700",children:"Uploading video..."}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all",style:{width:"".concat(g,"%")}})}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[g,"%"]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-700",children:B?"Drop the video file here":"Drag and drop your video here, or click to select"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Supported formats: MP4, WebM, OGG"}),y&&(0,r.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Project ID: ",y]})]})]})]}),v&&(0,r.jsx)("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-center",children:v}),d.video&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Preview"}),(0,r.jsxs)("button",{onClick:()=>{w(!j)},className:"flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),j?"Portrait Mode":"Landscape Mode"]})]}),(0,r.jsx)("div",{ref:C,className:"bg-black rounded-lg overflow-hidden transition-all duration-300 ".concat(j?"aspect-video":"aspect-[9/16] max-w-[400px] mx-auto"),children:(0,r.jsx)("video",{ref:k,src:d.video.url,className:"w-full h-full object-contain",controls:!0,onSeeked:P,onLoadedMetadata:P,onError:e=>{console.error("Video error:",e),b("Video failed to load. Please try uploading again.")},onLoadStart:()=>{console.log("Video load started")},onCanPlay:()=>{console.log("Video can play")},onLoadedData:()=>{console.log("Video data loaded")},playsInline:!0,preload:"metadata",crossOrigin:"anonymous",autoPlay:!1,loop:!1,width:"100%",height:"100%",poster:"",disablePictureInPicture:!0,disableRemotePlayback:!0,style:{display:"block"}})}),(0,r.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Duration:"})," ",(null==(t=d.video.metadata)?void 0:t.duration)?"".concat(d.video.metadata.duration.toFixed(2),"s"):"Unknown"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Size:"})," ",(null==(s=d.video.metadata)?void 0:s.size)?"".concat((d.video.metadata.size/1048576).toFixed(2)," MB"):"Unknown"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Resolution:"})," ",(null==(n=d.video.metadata)?void 0:n.width)&&(null==(l=d.video.metadata)?void 0:l.height)?"".concat(d.video.metadata.width," x ").concat(d.video.metadata.height):"Unknown"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Format:"})," ",(null==(o=d.video.metadata)?void 0:o.format)||"Unknown"]})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end pt-6",children:(0,r.jsx)("button",{onClick:()=>{d.video&&(c("video",{...d.video,type:j?"landscape":"portrait"}),x())},disabled:!d.video||h,className:"px-6 py-2 rounded-md text-white font-medium ".concat(!d.video||h?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:"Continue"})})]})},h=e=>{var t,s,n,l;let{formData:o,updateFormData:d,nextStep:c,prevStep:x}=e,[h,p]=(0,a.useState)(null),[g,f]=(0,a.useState)(0),[v,b]=(0,a.useState)({left:50,top:50}),[j,w]=(0,a.useState)(.2),[y,N]=(0,a.useState)({left:50,top:50}),[k,C]=(0,a.useState)(.2),[L,F]=(0,a.useState)(!1),[S,B]=(0,a.useState)(!1),[P,A]=(0,a.useState)(null),[M,E]=(0,a.useState)(!1),[T,_]=(0,a.useState)(!1),D=(0,a.useRef)(null),W=(0,a.useRef)(null),[I,U]=(0,a.useState)(!1),[H,z]=(0,a.useState)(!1),[R,V]=(0,a.useState)(null),[Y,G]=(0,a.useState)(!1),[O,X]=(0,a.useState)(!1),[q,J]=(0,a.useState)(!1),[Q,Z]=(0,a.useState)(!1),[K,$]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(null),[es,er]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(o.video&&o.video.metadata){let{width:e,height:t}=o.video.metadata;e&&t&&E(e>t)}},[o.video]);let ea=(0,a.useCallback)(()=>{var e,t,s,r;if(!W.current||!D.current)return null;let a=W.current.getBoundingClientRect(),n=D.current,l={left:a.left,top:a.top,width:a.width,height:a.height,right:a.right,bottom:a.bottom,x:a.x,y:a.y},i=(null==(t=o.video)||null==(e=t.metadata)?void 0:e.width)||n.videoWidth,d=(null==(r=o.video)||null==(s=r.metadata)?void 0:s.height)||n.videoHeight;if(i&&d){let e=a.width/a.height,t=i/d;if(e>t){let e=a.height*t,s=(a.width-e)/2;l={left:a.left+s,top:a.top,width:e,height:a.height,right:a.left+s+e,bottom:a.top+a.height,x:a.left+s,y:a.top}}else{let e=a.width/t,s=(a.height-e)/2;l={left:a.left,top:a.top+s,width:a.width,height:e,right:a.left+a.width,bottom:a.top+s+e,x:a.left,y:a.top+s}}}return l},[o.video]);(0,a.useEffect)(()=>{let e=()=>{let e=ea();if(e&&(er(e),D.current)){var t,s;console.log("PauseFrames - 视频元素实际宽高:",{videoWidth:D.current.videoWidth,videoHeight:D.current.videoHeight,displayWidth:e.width,displayHeight:e.height,containerWidth:null==(t=W.current)?void 0:t.getBoundingClientRect().width,containerHeight:null==(s=W.current)?void 0:s.getBoundingClientRect().height})}},t=()=>{e(),D.current&&console.log("PauseFrames - 视频元数据加载完成:",{videoWidth:D.current.videoWidth,videoHeight:D.current.videoHeight,duration:D.current.duration})};return window.addEventListener("resize",e),D.current&&D.current.addEventListener("loadedmetadata",t),e(),()=>{window.removeEventListener("resize",e),D.current&&D.current.removeEventListener("loadedmetadata",t)}},[ea]),(0,a.useEffect)(()=>{H&&D.current&&D.current.pause()},[H]);let en=()=>{if(!h)return void A("Please upload a guide image first");if(o.pauseFrames.find(e=>.1>Math.abs(e.time-g)))return void A("A pause frame already exists at ".concat(g.toFixed(1),"s. Please adjust the pause time to continue."));let e={...h,time:g,position:{...v},scale:j};h.buttonImage&&(e.buttonImage={id:h.buttonImage.id,url:h.buttonImage.url},e.buttonPosition={...y},e.buttonScale=k,console.log("Adding frame with button image:",e.buttonImage.id)),d("pauseFrames",[...o.pauseFrames,e]),p(null),X(!1),A(null)},el=(0,a.useCallback)(e=>{if(T||!es)return;let t=e.currentTarget.getBoundingClientRect();e.clientX,t.left,t.width,e.clientY,t.top,t.height,U(!0);let s=e=>{if(!es)return;let t=e.clientX-es.x,s=e.clientY-es.y;b({left:Math.max(0,Math.min(100,t/es.width*100)),top:Math.max(0,Math.min(100,s/es.height*100))})},r=()=>{U(!1),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r),e.preventDefault(),e.stopPropagation()},[T,es]),eo=(0,a.useCallback)(e=>{if(I||!es)return;let t=e.currentTarget.getBoundingClientRect();e.clientX,t.left,t.width,e.clientY,t.top,t.height,_(!0);let s=e=>{if(!es)return;let t=e.clientX-es.x,s=e.clientY-es.y;N({left:Math.max(0,Math.min(100,t/es.width*100)),top:Math.max(0,Math.min(100,s/es.height*100))})},r=()=>{_(!1),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r),e.preventDefault(),e.stopPropagation()},[I,es]);(0,a.useCallback)(()=>{U(!1),_(!1)},[]);let ei=()=>{D.current&&D.current.pause()},ed=(e,t)=>{let s=parseFloat(e.target.value);"left"===t?b(e=>({...e,left:s})):b(e=>({...e,top:s}))},ec=(e,t)=>{let s=parseFloat(e.target.value);"left"===t?N(e=>({...e,left:s})):N(e=>({...e,top:s}))},eu=async e=>{if(0!==e.length){if(!e[0].type.startsWith("image/"))return void A("Please upload an image file");try{A(null),F(!0);let t=new FormData;t.append("file",e[0]),t.append("type","image"),t.append("step","pause_frames"),t.append("project_id",o.project_id);let s=await fetch(u.upload,{method:"POST",body:t});if(!s.ok)throw Error("Failed to upload image");let r=await s.json();if(!r.success)throw Error(r.error||"Failed to upload image");if(H&&R){let e={...R,image:{id:r.file_id,url:m(r.url)}};V(e)}else{let e={id:"frame_".concat(Date.now()),time:g,image:{id:r.file_id,url:m(r.url)},position:{...v},scale:.2};p(e)}F(!1)}catch(t){let e=t instanceof Error?t.message:"An error occurred";console.error(e),A(e||"An error occurred during upload"),F(!1)}}},{getRootProps:em,getInputProps:ex,isDragActive:eh}=(0,i.VB)({onDrop:eu,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},disabled:L,maxFiles:1}),ep=async e=>{if(0!==e.length){if(!e[0].type.startsWith("image/"))return void A("Please upload an image file for the button");try{A(null),B(!0);let t=new FormData;t.append("file",e[0]),t.append("type","image"),t.append("step","pause_frames"),t.append("project_id",o.project_id),t.append("image_usage","button");let s=await fetch(u.upload,{method:"POST",body:t});if(!s.ok)throw Error("Failed to upload button image");let r=await s.json();if(!r.success)throw Error(r.error||"Failed to upload button image");if(H&&R){let e={...R,buttonImage:{id:r.file_id,url:m(r.url)},buttonPosition:y,buttonScale:k};V(e)}else if(h){let e={...h,buttonImage:{id:r.file_id,url:m(r.url)},buttonPosition:y,buttonScale:k};p(e)}B(!1)}catch(t){let e=t instanceof Error?t.message:"An error occurred";console.error(e),A(e||"An error occurred during button image upload"),B(!1)}}},{getRootProps:eg,getInputProps:ef,isDragActive:ev}=(0,i.VB)({onDrop:ep,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},disabled:S,maxFiles:1});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Add Pause Frames"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Add frames that will pause the video at specific times"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Video Preview"}),(0,r.jsxs)("button",{onClick:()=>{E(!M),h&&!H&&et(()=>window.confirm("You have an unsaved pause frame. Would you like to save it first?")?(en(),()=>{}):(p(null),()=>{}))},className:"flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),M?"Portrait Mode":"Landscape Mode"]})]}),(0,r.jsxs)("div",{ref:W,className:"bg-black rounded-lg overflow-hidden relative transition-all duration-300 ".concat(M?"aspect-video":"aspect-[9/16] max-w-[400px] mx-auto"),children:[(0,r.jsx)("video",{ref:D,src:o.video.url,className:"w-full h-full object-contain",onTimeUpdate:()=>{D.current&&f(parseFloat(D.current.currentTime.toFixed(2)))},onPause:()=>{D.current&&f(parseFloat(D.current.currentTime.toFixed(2)))},onSeeked:()=>{Y||Q||H||!D.current||!D.current.paused||D.current.play().catch(e=>console.error("Auto play failed:",e))}}),H&&(0,r.jsx)("div",{className:"absolute inset-0 bg-transparent z-5",onClick:e=>{e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),D.current&&D.current.pause())}}),(null==h?void 0:h.buttonImage)&&es&&(0,r.jsx)("div",{className:"absolute ".concat(T?"pointer-events-none":"cursor-move"),style:{left:"".concat(y.left,"%"),top:"".concat(y.top,"%"),transform:"translate(-50%, -50%)",width:"".concat(100*k,"%"),zIndex:10,transition:T?"none":"transform 0.1s ease-out"},onMouseDown:eo,children:(0,r.jsx)("img",{src:h.buttonImage.url,alt:"Button",width:48,height:48,className:"pointer-events-none w-full h-full object-contain"})}),H&&(null==R?void 0:R.buttonImage)&&es&&(0,r.jsx)("div",{className:"absolute ".concat(T?"pointer-events-none":"cursor-move"),style:{left:"".concat(y.left,"%"),top:"".concat(y.top,"%"),transform:"translate(-50%, -50%)",width:"".concat(100*k,"%"),zIndex:10,transition:T?"none":"transform 0.1s ease-out"},onMouseDown:eo,children:(0,r.jsx)("img",{src:R.buttonImage.url,alt:"Button",width:48,height:48,className:"pointer-events-none w-full h-full object-contain"})}),h&&es&&(0,r.jsx)("div",{className:"absolute ".concat(I?"pointer-events-none":"cursor-move"),style:{left:"".concat(v.left,"%"),top:"".concat(v.top,"%"),transform:"translate(-50%, -50%)",width:"".concat(100*j,"%"),zIndex:20,transition:I?"none":"transform 0.1s ease-out"},onMouseDown:el,children:(0,r.jsx)("img",{src:h.image.url,alt:"Guide",width:48,height:48,className:"pointer-events-none w-full h-full object-contain"})}),H&&R&&es&&(0,r.jsx)("div",{className:"absolute ".concat(I?"pointer-events-none":"cursor-move"),style:{left:"".concat(v.left,"%"),top:"".concat(v.top,"%"),transform:"translate(-50%, -50%)",width:"".concat(100*j,"%"),zIndex:20,transition:I?"none":"transform 0.1s ease-out"},onMouseDown:el,children:(0,r.jsx)("img",{src:R.image.url,alt:"Guide",width:48,height:48,className:"pointer-events-none w-full h-full object-contain"})})]})]}),(0,r.jsxs)("div",{children:[!q&&!O&&!H&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsxs)("button",{onClick:()=>{h&&!H&&et(()=>window.confirm("You have an unsaved pause frame. Would you like to save it first?")?(en(),()=>{}):(p(null),()=>{})),p(null),z(!1),V(null),A(null),X(!0)},className:"flex-1 flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Frame"]}),o.pauseFrames.length>0&&(0,r.jsxs)("button",{onClick:()=>{if(0===o.pauseFrames.length)return void A("No frames to copy");J(!0)},className:"flex-1 flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Frame"]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-2 text-center",children:0===o.pauseFrames.length?"Click 'Create New Frame' to add your first pause frame":"Create a new frame or copy settings from an existing frame"})]}),q&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-800 mb-3",children:"Select Frame to Copy"}),(0,r.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:o.pauseFrames.map((e,t)=>(0,r.jsxs)("button",{onClick:()=>(e=>{if(h&&!H&&et(()=>window.confirm("You have an unsaved pause frame. Would you like to save it first?")?(en(),()=>{}):(p(null),()=>{})),D.current){D.current.currentTime=e.time,D.current.pause();let t=()=>{var e;return null==(e=D.current)||e.pause(),!1};D.current.onplay=t,D.current.onclick=t,D.current.onkeydown=t}z(!0),V(e),f(e.time),b(e.position),w(e.scale||1),N(e.buttonPosition||{left:50,top:50}),C(e.buttonScale||.2),X(!0)})(e),className:"w-full flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[(0,r.jsx)("div",{className:"h-10 w-10 flex-shrink-0 rounded overflow-hidden bg-gray-200 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:e.image.url,alt:"Frame preview",width:48,height:48,className:"w-full h-full object-contain"})}),(0,r.jsxs)("div",{className:"ml-3 flex-grow min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-800 truncate",children:["Frame #",t+1," (",e.time.toFixed(1),"s)"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Position: ",e.position.left.toFixed(0),"% left, ",e.position.top.toFixed(0),"% top • Scale: ",e.scale?"".concat(e.scale.toFixed(1),"x"):"1.0x"]})]}),(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},e.id))}),(0,r.jsx)("div",{className:"mt-3 flex justify-end",children:(0,r.jsx)("button",{onClick:()=>J(!1),className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})})]}),O&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-800",children:H?"Edit Pause Frame":"Create Pause Frame"}),(0,r.jsx)("button",{onClick:()=>{X(!1),p(null),z(!1),V(null),A(null)},className:"px-4 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors font-medium text-sm",children:"Cancel"})]}),(h||H&&R)&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-800 mb-3",children:"Frame Preview"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"h-16 w-16 flex-shrink-0 rounded overflow-hidden bg-gray-200 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:(null==(t=h||R)?void 0:t.image.url)||"",alt:"Frame preview",width:48,height:48,className:"w-full h-full object-contain"})}),(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Time:"}),(0,r.jsxs)("p",{className:"font-medium",children:[g.toFixed(1),"s"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Position:"}),(0,r.jsxs)("p",{className:"font-medium",children:[v.left.toFixed(0),"% left, ",v.top.toFixed(0),"% top"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Scale:"}),(0,r.jsxs)("p",{className:"font-medium",children:[j.toFixed(1),"x"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Status:"}),(0,r.jsx)("p",{className:"font-medium text-green-600",children:H?"Editing":"Ready to add"})]})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[!h&&!R&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frame Image"}),(0,r.jsxs)("div",{...em(),className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ".concat(eh?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"," ").concat(L?"opacity-75":""),children:[(0,r.jsx)("input",{...ex()}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),L?(0,r.jsx)("p",{className:"text-gray-700",children:"Uploading image..."}):(0,r.jsx)("p",{className:"text-gray-700",children:eh?"Drop the image here":"Drag and drop your guide image here, or click to select"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Supported formats: PNG, JPG, GIF, WebP"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pause Time (seconds)"}),(0,r.jsx)("input",{type:"range",min:"0",max:(null==(s=o.video.metadata)?void 0:s.duration)||30,step:"0.1",value:g,onChange:e=>{let t=parseFloat(e.target.value);f(t),D.current&&(D.current.currentTime=t)},onInput:e=>{if(D.current){let t=parseFloat(e.target.value);D.current.currentTime=t}},onMouseUp:ei,onTouchEnd:ei,className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0s"}),(0,r.jsxs)("span",{className:"font-medium",children:[g.toFixed(1),"s"]}),(0,r.jsxs)("span",{children:[((null==(n=o.video.metadata)?void 0:n.duration)||30).toFixed(1),"s"]})]})]}),(h||R)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guide Image Position & Size"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Left Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:v.left,onChange:e=>ed(e,"left"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[v.left.toFixed(0),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Top Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:v.top,onChange:e=>ed(e,"top"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[v.top.toFixed(0),"%"]})]})]}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Guide Image Width (% of screen)"}),(0,r.jsx)("input",{type:"range",min:"10",max:"100",step:"1",value:100*j,onChange:e=>{w(parseFloat(e.target.value)/100)},className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"10%"}),(0,r.jsxs)("span",{className:"font-medium",children:[Math.round(100*j),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-100 rounded-md p-3 mt-2",children:(0,r.jsxs)("p",{className:"text-xs text-blue-700 flex items-center",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"You can position the guide image by dragging it directly on the video preview."]})})]}),(h||R)&&(0,r.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Button Image (Optional)"}),(0,r.jsx)("div",{className:"text-xs text-blue-600",children:"Continues playback on click"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsxs)("svg",{className:"h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:["Add a button image to continue the playback flow. When users click on this button during the pause frame, the video will resume playing.",!(null==h?void 0:h.buttonImage)&&!(null==R?void 0:R.buttonImage)&&(0,r.jsx)("span",{className:"block mt-1 text-gray-500 italic",children:'If no button image is provided, a default "click_area.png" will be used.'})]})]}),(null==h?void 0:h.buttonImage)||H&&(null==R?void 0:R.buttonImage)?(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-white",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"h-12 w-12 flex-shrink-0 rounded overflow-hidden bg-gray-100 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:null==(l=(null==h?void 0:h.buttonImage)||(null==R?void 0:R.buttonImage))?void 0:l.url,alt:"Button",className:"w-full h-full object-contain",draggable:"false"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Button Image"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Custom button uploaded"})]})]}),(0,r.jsx)("button",{onClick:()=>{if(H&&R){let{buttonImage:e,buttonPosition:t,buttonScale:s,...r}=R;V(r)}else if(h){let{buttonImage:e,buttonPosition:t,buttonScale:s,...r}=h;p(r)}},className:"px-3 py-1 text-xs text-red-600 hover:text-red-800 transition-colors",children:"Remove"})]}):(0,r.jsxs)("div",{...eg(),className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400 transition-colors ".concat(ev?"bg-blue-50 border-blue-400":""," ").concat(S?"opacity-70":""),children:[(0,r.jsx)("input",{...ef()}),(0,r.jsx)("svg",{className:"mx-auto h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),S?(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Uploading..."}):(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:ev?"Drop the button image here":"Click to upload a button image"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Recommended: "Continue", "Play", or "Next" styled buttons'})]}),((null==h?void 0:h.buttonImage)||H&&(null==R?void 0:R.buttonImage))&&(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Button Position & Size"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Left Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:y.left,onChange:e=>ec(e,"left"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[y.left.toFixed(0),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Top Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:y.top,onChange:e=>ec(e,"top"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[y.top.toFixed(0),"%"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Button Width (% of screen)"}),(0,r.jsx)("input",{type:"range",min:"10",max:"100",step:"1",value:100*k,onChange:e=>{C(parseFloat(e.target.value)/100)},className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"10%"}),(0,r.jsxs)("span",{className:"font-medium",children:[Math.round(100*k),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-100 rounded-md p-3",children:(0,r.jsxs)("p",{className:"text-xs text-blue-700 flex items-center",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"You can also position the button by clicking and dragging it directly on the video preview."]})})]})]})]}),P&&(0,r.jsx)("div",{className:"mt-4 bg-red-50 text-red-600 p-3 rounded-md text-center text-sm",children:P}),(0,r.jsx)("div",{className:"mt-6",children:H?(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{if(!R)return;let e={...R,time:g,position:{...v},scale:j};R.buttonImage&&(e.buttonImage={id:R.buttonImage.id,url:R.buttonImage.url},e.buttonPosition={...y},e.buttonScale=k,console.log("Saving frame with button image:",e.buttonImage.id)),d("pauseFrames",o.pauseFrames.map(t=>t.id===e.id?e:t)),z(!1),V(null),X(!1)},className:"flex-1 py-3 rounded-lg font-medium bg-green-600 text-white hover:bg-green-700",children:"Save Changes"}),(0,r.jsx)("button",{onClick:()=>{ee?ee():(z(!1),V(null),A(null),X(!1),J(!1),Z(!1),$(!1),et(null))},className:"flex-1 py-3 rounded-lg font-medium border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"})]}):(0,r.jsx)("button",{onClick:en,disabled:!h||L,className:"w-full py-3 rounded-lg font-medium ".concat(!h||L?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:h?"Add Pause Frame":"Upload Image First"})})]}),o.pauseFrames.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-800",children:["Your Pause Frames (",o.pauseFrames.length,")"]}),(0,r.jsx)("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:o.pauseFrames.map((e,t)=>{var s,a;return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"font-medium text-gray-700",children:["Frame #",t+1," ",(0,r.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["(",e.time.toFixed(1),"s)"]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{onClick:()=>(e=>{if(h&&!H&&et(()=>window.confirm("You have an unsaved pause frame. Would you like to save it first?")?(en(),()=>{}):(p(null),()=>{})),D.current){D.current.currentTime=e.time,D.current.pause(),D.current.controls=!1;let t=()=>{var e;return null==(e=D.current)||e.pause(),!1};D.current.onplay=t,D.current.onclick=t,D.current.onkeydown=t}z(!0),V(e),f(e.time),b(e.position),w(e.scale||1),N(e.buttonPosition||{left:50,top:50}),C(e.buttonScale||.2),X(!0)})(e),className:"p-1 text-blue-500 hover:text-blue-700",title:"Edit frame",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void(window.confirm("Are you sure you want to delete this pause frame?")&&d("pauseFrames",o.pauseFrames.filter(e=>e.id!==t)))},className:"p-1 text-red-500 hover:text-red-700",title:"Delete frame",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),(0,r.jsxs)("div",{className:"p-3 flex items-start",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("div",{className:"h-12 w-12 flex-shrink-0 rounded overflow-hidden bg-gray-200 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:e.image.url,alt:"Guide",width:48,height:48,className:"w-full h-full object-contain"})}),e.buttonImage&&(0,r.jsxs)("div",{className:"h-12 w-12 flex-shrink-0 rounded overflow-hidden bg-gray-100 border border-gray-300 flex items-center justify-center relative",children:[(0,r.jsx)("img",{src:e.buttonImage.url,alt:"Button",width:48,height:48,className:"w-full h-full object-contain"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-0 bg-blue-500 text-white text-xs px-1 rounded-tl",children:"BTN"})]})]}),(0,r.jsx)("div",{className:"ml-3 flex-grow min-w-0",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Position:"}),(0,r.jsxs)("p",{className:"font-medium truncate",children:[e.position.left.toFixed(0),"% left, ",e.position.top.toFixed(0),"% top"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Scale:"}),(0,r.jsx)("p",{className:"font-medium",children:e.scale?"".concat(e.scale.toFixed(1),"x"):"1.0x"})]}),e.buttonImage&&(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Button:"}),(0,r.jsxs)("p",{className:"font-medium text-xs truncate",children:["Pos: ",null==(s=e.buttonPosition)?void 0:s.left.toFixed(0),"% L, ",null==(a=e.buttonPosition)?void 0:a.top.toFixed(0),"% T • Scale: ",e.buttonScale?"".concat(e.buttonScale.toFixed(1),"x"):"0.2x"]})]})]})})]})]},e.id)})})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,r.jsx)("button",{onClick:x,className:"px-6 py-2 rounded-md text-gray-700 font-medium border border-gray-300 hover:bg-gray-50",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{if(0===o.pauseFrames.length)return void alert("Please add at least one pause frame.");c()},disabled:0===o.pauseFrames.length,className:"px-6 py-2 rounded-md font-medium ".concat(0===o.pauseFrames.length?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:"Continue"})]}),K&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Unsaved Changes"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"You have an unsaved pause frame. Would you like to save it first?"}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{ee&&ee(),$(!1),et(null)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Save & Continue"}),(0,r.jsx)("button",{onClick:()=>{p(null),$(!1),et(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"Discard"})]})]})})]})},p=e=>{var t,s;let{formData:n,updateFormData:l,nextStep:o,prevStep:d}=e,[c,x]=(0,a.useState)(null),[h,p]=(0,a.useState)("fulltime"),[g,f]=(0,a.useState)({left:20,top:20}),[v,b]=(0,a.useState)(.2),[j,w]=(0,a.useState)(.1),[y,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[L,F]=(0,a.useState)(!1),[S,B]=(0,a.useState)(!1),P=(0,a.useRef)(null),A=(0,a.useRef)(null),[M,E]=(0,a.useState)(!1),[T,_]=(0,a.useState)(null),[D,W]=(0,a.useState)(null),[I,U]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(n.video&&n.video.metadata){let{width:e,height:t}=n.video.metadata;e&&t&&F(e>t)}},[n.video]);let H=(0,a.useCallback)(()=>{var e,t,s,r;if(!A.current||!P.current)return null;let a=A.current.getBoundingClientRect(),l=P.current,o={left:a.left,top:a.top,width:a.width,height:a.height,right:a.right,bottom:a.bottom,x:a.x,y:a.y},i=(null==(t=n.video)||null==(e=t.metadata)?void 0:e.width)||l.videoWidth,d=(null==(r=n.video)||null==(s=r.metadata)?void 0:s.height)||l.videoHeight;if(i&&d){console.log("使用视频原始宽高:",i,d);let e=a.width/a.height,t=i/d;if(e>t){let e=a.height*t,s=(a.width-e)/2;o={left:a.left+s,top:a.top,width:e,height:a.height,right:a.left+s+e,bottom:a.top+a.height,x:a.left+s,y:a.top}}else{let e=a.width/t,s=(a.height-e)/2;o={left:a.left,top:a.top+s,width:a.width,height:e,right:a.left+a.width,bottom:a.top+s+e,x:a.left,y:a.top+s}}}return o},[n.video]);if((0,a.useEffect)(()=>{let e=()=>{let e=H();if(e&&(U(e),P.current)){var t,s;console.log("视频元素实际宽高:",{videoWidth:P.current.videoWidth,videoHeight:P.current.videoHeight,displayWidth:e.width,displayHeight:e.height,containerWidth:null==(t=A.current)?void 0:t.getBoundingClientRect().width,containerHeight:null==(s=A.current)?void 0:s.getBoundingClientRect().height})}},t=()=>{e(),P.current&&console.log("视频元数据加载完成:",{videoWidth:P.current.videoWidth,videoHeight:P.current.videoHeight,duration:P.current.duration})};return window.addEventListener("resize",e),P.current&&P.current.addEventListener("loadedmetadata",t),e(),()=>{window.removeEventListener("resize",e),P.current&&P.current.removeEventListener("loadedmetadata",t)}},[H]),!n.video)return(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-red-500",children:"Please upload a video first"}),(0,r.jsx)("button",{onClick:d,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:"Go Back"})]});let z=()=>{B(!1)},R=(e,t)=>{let s=parseInt(e.target.value);f(e=>({...e,[t]:s}))},V=async e=>{if(0===e.length)return;let t=e[0];if(!t.type.startsWith("image/"))return void C("Please upload an image file");try{C(null),N(!0);let e=new FormData;e.append("file",t),e.append("type","image"),e.append("step","cta_buttons"),e.append("project_id",n.project_id);let s=await fetch(u.upload,{method:"POST",body:e});if(!s.ok)throw Error("Failed to upload image");let r=await s.json();if(!r.success)throw Error(r.error||"Failed to upload image");let a={id:"button_".concat(Date.now()),type:T||h,image:{id:r.file_id,url:m(r.url)},position:{...g},scale:v};"endscreen"===(T||h)?(a.startTime=j,P.current&&P.current.pause()):(P.current&&(P.current.currentTime=0,P.current.pause()),w(0)),x(a),N(!1)}catch(e){C(e instanceof Error?e.message:"An error occurred"),N(!1)}},{getRootProps:Y,getInputProps:G,isDragActive:O}=(0,i.VB)({onDrop:V,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},disabled:y,maxFiles:1}),X=()=>{if(!c)return void C("Please upload a CTA button image first");let e=T||h;if(n.ctaButtons.find(t=>t.type===e))return void C("A ".concat("fulltime"===e?"Full-time":"End Screen"," button already exists. You can only add one button of each type."));if("endscreen"===e&&0===j)return void C("End Screen button cannot start at 0s. Please set a valid time (minimum 0.1s).");let t={...c,type:e,position:{...g},scale:v};"endscreen"===e&&(t.startTime=j),l("ctaButtons",[...n.ctaButtons,t]),x(null),_(null),C(null)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Add CTA Buttons"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Add call-to-action buttons to your playable ad"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Video"}),(0,r.jsxs)("button",{onClick:()=>{F(!L)},className:"flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),L?"Portrait Mode":"Landscape Mode"]})]}),(0,r.jsxs)("div",{ref:A,className:"bg-black rounded-lg overflow-hidden relative transition-all duration-300 ".concat(L?"aspect-video":"aspect-[9/16] max-w-[400px] mx-auto"),children:[(0,r.jsx)("video",{ref:P,src:n.video.url,className:"w-full h-full object-contain pointer-events-none",onTimeUpdate:()=>{P.current&&w(parseFloat(P.current.currentTime.toFixed(2)))},onPause:()=>{P.current&&w(parseFloat(P.current.currentTime.toFixed(2)))},onSeeked:()=>{!S&&null===(T||h)&&P.current&&P.current.paused&&P.current.play().catch(e=>console.error("Auto play failed:",e))}}),c&&I&&(0,r.jsx)("div",{className:"absolute cursor-move ".concat(M?"pointer-events-none":""),style:{left:"".concat(g.left,"%"),top:"".concat(g.top,"%"),transform:"translate(-50%, -50%)",width:"".concat(100*v,"%")},onMouseDown:e=>{if(!A.current||!I)return;E(!0);let t=e.clientX,s=e.clientY,r=g.left,a=g.top,n=e=>{if(!I)return;let n=e.clientX-t,l=e.clientY-s,o=n/I.width*100;f({left:Math.max(0,Math.min(100,r+o)),top:Math.max(0,Math.min(100,a+l/I.height*100))})},l=()=>{E(!1),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",l)},children:(0,r.jsx)("img",{src:c.image.url,alt:"CTA Button",className:"w-full h-full object-contain pointer-events-none"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-800",children:["CTA Buttons (",n.ctaButtons.length,"/2)"]}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-1",children:[(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(n.ctaButtons.some(e=>"fulltime"===e.type)?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"),children:[n.ctaButtons.some(e=>"fulltime"===e.type)?"✓":"○"," Full-time"]}),(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(n.ctaButtons.some(e=>"endscreen"===e.type)?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"),children:[n.ctaButtons.some(e=>"endscreen"===e.type)?"✓":"○"," End Screen"]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{x(null),C(null),p("fulltime"),_("fulltime");let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];s&&V([s])},e.click()},disabled:n.ctaButtons.some(e=>"fulltime"===e.type),className:"px-3 py-2 rounded-md font-medium text-sm transition-colors ".concat(n.ctaButtons.some(e=>"fulltime"===e.type)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:"+ Full-time Button"}),(0,r.jsx)("button",{onClick:()=>{x(null),C(null),p("endscreen"),_("endscreen");let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];s&&V([s])},e.click()},disabled:n.ctaButtons.some(e=>"endscreen"===e.type),className:"px-3 py-2 rounded-md font-medium text-sm transition-colors ".concat(n.ctaButtons.some(e=>"endscreen"===e.type)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-100 text-green-700 hover:bg-green-200"),children:"+ End Screen Button"})]})]}),!c&&(0,r.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-800 mb-2",children:"Add Call-to-Action Buttons"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Click one of the buttons above to add a Full-time or End Screen CTA button"}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-blue-800",children:"Button Display Logic"}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-blue-700",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Full-time Button:"})," Shows throughout the video until the End Screen button appears."]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"End Screen Button:"})," Shows at the specified time and replaces the Full-time button."]}),(0,r.jsx)("p",{className:"mt-1 text-blue-600",children:(0,r.jsx)("em",{children:"Note: Only one button is visible at a time."})})]})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"text-center p-4 border-2 border-dashed border-gray-300 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"⏱️"}),(0,r.jsx)("h5",{className:"font-medium text-gray-800",children:"Full-time Button"})]}),(0,r.jsxs)("div",{className:"text-center p-4 border-2 border-dashed border-gray-300 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFAF"}),(0,r.jsx)("h5",{className:"font-medium text-gray-800",children:"End Screen Button"})]})]})]})}),c&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h4",{className:"text-lg font-medium text-gray-800",children:[D?"Edit":"Configure"," ","fulltime"===(T||h)?"Full-time":"End Screen"," Button"]}),(0,r.jsx)("button",{onClick:()=>{x(null),C(null),_(null),W(null)},className:"px-4 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors font-medium text-sm",children:"Cancel"})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-800 mb-3",children:"Button Preview"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"h-16 w-16 flex-shrink-0 rounded overflow-hidden bg-gray-200 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:c.image.url,alt:"Button preview",className:"w-full h-full object-contain"})}),(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Type:"}),(0,r.jsx)("p",{className:"font-medium",children:"fulltime"===(T||h)?"Full-time":"End Screen"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Position:"}),(0,r.jsxs)("p",{className:"font-medium",children:[g.left.toFixed(0),"% left, ",g.top.toFixed(0),"% top"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Scale:"}),(0,r.jsxs)("p",{className:"font-medium",children:[v.toFixed(1),"x"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Status:"}),(0,r.jsx)("p",{className:"font-medium text-green-600",children:"Ready to add"})]})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:["endscreen"===(T||h)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time (seconds)"}),(0,r.jsx)("input",{type:"range",min:"0.1",max:(null==(t=n.video.metadata)?void 0:t.duration)||30,step:"0.1",value:j,onChange:e=>{let t=parseFloat(e.target.value);w(t),P.current&&(P.current.currentTime=t,P.current.pause()),B(!0)},onMouseUp:z,onTouchEnd:z,className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0.1s"}),(0,r.jsxs)("span",{className:"font-medium",children:[j.toFixed(1),"s"]}),(0,r.jsxs)("span",{children:[((null==(s=n.video.metadata)?void 0:s.duration)||30).toFixed(1),"s"]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"End Screen button cannot start at 0s. Minimum time is 0.1s."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Left Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:g.left,onChange:e=>R(e,"left"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[g.left.toFixed(0),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Top Position (%)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:g.top,onChange:e=>R(e,"top"),className:"w-full"}),(0,r.jsxs)("div",{className:"text-center text-xs text-gray-500 mt-1",children:[g.top.toFixed(0),"%"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Width (% of screen)"}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:100*v,onChange:e=>{b(parseFloat(e.target.value)/100)},className:"w-full"}),(0,r.jsx)("div",{className:"flex justify-center text-xs text-gray-500 mt-1",children:(0,r.jsxs)("span",{className:"font-medium",children:[Math.round(100*v),"%"]})})]})]}),k&&(0,r.jsx)("div",{className:"mt-4 bg-red-50 text-red-600 p-3 rounded-md text-center text-sm",children:k}),(0,r.jsx)("div",{className:"mt-6",children:D?(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{if(!D||!c)return;if("endscreen"===D.type&&0===j)return void C("End Screen button cannot start at 0s. Please set a valid time.");let e={...D,position:{...g},scale:v,startTime:"endscreen"===D.type?j:void 0};l("ctaButtons",n.ctaButtons.map(t=>t.id===D.id?e:t)),W(null),x(null),_(null),C(null)},className:"flex-1 py-3 rounded-lg font-medium bg-green-600 text-white hover:bg-green-700",children:"Save Changes"}),(0,r.jsx)("button",{onClick:()=>{W(null),x(null),_(null),C(null)},className:"flex-1 py-3 rounded-lg font-medium border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"})]}):(0,r.jsx)("button",{onClick:X,disabled:y,className:"w-full py-3 rounded-lg font-medium ".concat(y?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:y?"Uploading...":"Add ".concat("fulltime"===(T||h)?"Full-time":"End Screen"," Button")})})]}),n.ctaButtons.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-800 mb-3",children:"Your CTA Buttons"}),(0,r.jsx)("div",{className:"space-y-3 max-h-48 overflow-y-auto pr-2",children:n.ctaButtons.map((e,t)=>(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-10 w-10 flex-shrink-0 rounded overflow-hidden bg-gray-200 border border-gray-300 flex items-center justify-center",children:(0,r.jsx)("img",{src:e.image.url,alt:"CTA Button",className:"w-full h-full object-contain"})}),(0,r.jsxs)("div",{className:"ml-3 flex-grow min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-800 truncate",children:["Button #",t+1," (","fulltime"===e.type?"Full-time":"End Screen",")"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["endscreen"===e.type&&void 0!==e.startTime?0===e.startTime?"⚠️ Invalid time (0.0s) - Please edit to set a valid time • ":"Appears at ".concat(e.startTime.toFixed(1),"s • "):"Shows until End Screen button appears • ",e.position.left.toFixed(0),"% left, ",e.position.top.toFixed(0),"% top",e.scale?" • Width: ".concat(Math.round(100*e.scale),"%"):""]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:["endscreen"===e.type&&0===e.startTime&&(0,r.jsx)("button",{onClick:()=>(e=>{W(e),x(e),p(e.type),f({left:e.position.left,top:e.position.top}),b(e.scale),w(e.startTime||0),_(e.type)})(e),className:"p-1 text-orange-500 hover:text-orange-700 flex-shrink-0",title:"Edit button time",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void(l("ctaButtons",n.ctaButtons.filter(e=>e.id!==t)),W(null),x(null),_(null),C(null))},className:"p-1 text-red-500 hover:text-red-700 flex-shrink-0",title:"Delete button",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,r.jsx)("button",{onClick:d,className:"px-6 py-2 rounded-md text-gray-700 font-medium border border-gray-300 hover:bg-gray-50",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{let e=n.ctaButtons.filter(e=>"fulltime"===e.type),t=n.ctaButtons.filter(e=>"endscreen"===e.type);return 0===e.length?void C("Please add at least one Full-time CTA button"):0===t.length?void C("Please add at least one End Screen CTA button"):void(c&&window.confirm("You have an unsaved CTA button. Would you like to save it before continuing?")&&X(),o())},disabled:!n.ctaButtons.some(e=>"fulltime"===e.type)||!n.ctaButtons.some(e=>"endscreen"===e.type),className:"px-6 py-2 rounded-md font-medium ".concat(n.ctaButtons.some(e=>"fulltime"===e.type)&&n.ctaButtons.some(e=>"endscreen"===e.type)?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Continue"})]})]})},g=e=>{var t,s,n,l,o,d,c,x,h,p,g,f,v,b,j,w,y,N,k,C,L,F,S,B,P,A,M,E,T,_,D,W,I,U,H,z,R,V,Y,G,O,X;let{formData:q,updateFormData:J,nextStep:Q,prevStep:Z}=e,[K,$]=(0,a.useState)(null),[ee,et]=(0,a.useState)(null),[es,er]=(0,a.useState)(!0),[ea,en]=(0,a.useState)(!1),[el,eo]=(0,a.useState)(!1),[ei,ed]=(0,a.useState)(!1),[ec,eu]=(0,a.useState)(null),em=(0,a.useRef)(null);if((0,a.useEffect)(()=>{if(q.video&&q.video.metadata){let{width:e,height:t}=q.video.metadata;e&&t&&(en(e>t),er(!0))}},[q.video]),!q.video)return(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("p",{className:"text-red-500",children:"Please upload a video first"}),(0,r.jsx)("button",{onClick:Z,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:"Go Back"})]});let ex=async e=>{await ep(e,"left")},eh=async e=>{await ep(e,"right")},ep=async(e,t)=>{if(0===e.length)return;let s=e[0];if(!s.type.startsWith("image/"))return void et("Please upload an image file");try{et(null),$(t);let e=new FormData;e.append("file",s),e.append("type","image"),e.append("step","banner_images"),e.append("project_id",q.project_id),e.append("position",t);let r=await fetch(u.upload,{method:"POST",body:e});if(!r.ok)throw Error("Failed to upload ".concat(t," banner"));let a=await r.json();if(!a.success)throw Error(a.error||"Failed to upload ".concat(t," banner"));J("banners",{...q.banners,[t]:{id:a.file_id,url:m(a.url),position:"left"===t?ea?{left:0,top:50}:{left:0,top:0}:ea?{left:83.33,top:50}:{left:50,top:83.33},scale:1}}),$(null)}catch(e){et(e instanceof Error?e.message:"An error occurred"),$(null)}},{getRootProps:eg,getInputProps:ef,isDragActive:ev}=(0,i.VB)({onDrop:ex,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},disabled:null!==K,maxFiles:1}),{getRootProps:eb,getInputProps:ej,isDragActive:ew}=(0,i.VB)({onDrop:eh,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},disabled:null!==K,maxFiles:1}),ey=e=>{let t={...q.banners};t[e]=null,J("banners",t)},eN=(e,t)=>{e.preventDefault(),ed(!0),eu(t)},ek=()=>{ed(!1),eu(null)},eC=(e,t)=>{let s={...q.banners};s[e]&&(s[e]={...s[e],scale:t},J("banners",s))};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Add Banner Images (Optional)"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Add banner images for landscape mode display"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Video"}),(0,r.jsxs)("button",{onClick:()=>{er(!es)},className:"flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),es?"Portrait Mode":"Landscape Mode"]})]}),(0,r.jsxs)("div",{className:"bg-black rounded-lg overflow-hidden relative transition-all duration-300 ".concat(es?"aspect-video":"aspect-[9/16] max-w-[400px] mx-auto"),onMouseMove:e=>{if(!ei||!ec)return;let t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*100,r=(e.clientY-t.top)/t.height*100,a=Math.max(0,Math.min(100,s)),n=Math.max(0,Math.min(100,r)),l={...q.banners};l[ec]&&(l[ec]={...l[ec],position:{left:a,top:n}},J("banners",l))},onMouseUp:ek,onMouseLeave:ek,children:[(0,r.jsx)("video",{ref:em,src:q.video.url,className:"w-full h-full object-contain pointer-events-none",onSeeked:()=>{!el&&em.current&&em.current.paused&&em.current.play().catch(e=>console.error("Auto play failed:",e))}}),ea?!es&&(0,r.jsxs)(r.Fragment,{children:[(null==(t=q.banners)?void 0:t.left)&&(0,r.jsx)("div",{className:"absolute cursor-move",style:{left:"".concat((null==(s=q.banners.left.position)?void 0:s.left)||0,"%"),top:"".concat((null==(n=q.banners.left.position)?void 0:n.top)||0,"%"),transform:"translate(-50%, -50%) scale(".concat(q.banners.left.scale||1,")"),width:"16.67%",height:"16.67%"},onMouseDown:e=>eN(e,"left"),children:(0,r.jsx)("img",{src:q.banners.left.url,alt:"Left Banner",className:"w-full h-full object-contain"})}),(null==(l=q.banners)?void 0:l.right)&&(0,r.jsx)("div",{className:"absolute cursor-move",style:{left:"".concat((null==(o=q.banners.right.position)?void 0:o.left)||50,"%"),top:"".concat((null==(d=q.banners.right.position)?void 0:d.top)||83.33,"%"),transform:"translate(-50%, -50%) scale(".concat(q.banners.right.scale||1,")"),width:"16.67%",height:"16.67%"},onMouseDown:e=>eN(e,"right"),children:(0,r.jsx)("img",{src:q.banners.right.url,alt:"Right Banner",className:"w-full h-full object-contain"})})]}):es&&(0,r.jsxs)(r.Fragment,{children:[(null==(c=q.banners)?void 0:c.left)&&(0,r.jsx)("div",{className:"absolute cursor-move",style:{left:"".concat((null==(x=q.banners.left.position)?void 0:x.left)||0,"%"),top:"".concat((null==(h=q.banners.left.position)?void 0:h.top)||50,"%"),transform:"translate(-50%, -50%) scale(".concat(q.banners.left.scale||1,")"),width:"16.67%",height:"100%"},onMouseDown:e=>eN(e,"left"),children:(0,r.jsx)("img",{src:q.banners.left.url,alt:"Top Banner",className:"w-full h-full object-contain"})}),(null==(p=q.banners)?void 0:p.right)&&(0,r.jsx)("div",{className:"absolute cursor-move",style:{left:"".concat((null==(g=q.banners.right.position)?void 0:g.left)||83.33,"%"),top:"".concat((null==(f=q.banners.right.position)?void 0:f.top)||50,"%"),transform:"translate(-50%, -50%) scale(".concat(q.banners.right.scale||1,")"),width:"16.67%",height:"100%"},onMouseDown:e=>eN(e,"right"),children:(0,r.jsx)("img",{src:q.banners.right.url,alt:"Bottom Banner",className:"w-full h-full object-contain"})})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Add Banner Images"}),((null==(v=q.banners)?void 0:v.left)||(null==(b=q.banners)?void 0:b.right))&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("svg",{className:"h-5 w-5 text-blue-400 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Note"}),(0,r.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:(null==(j=q.banners)?void 0:j.left)&&(null==(w=q.banners)?void 0:w.right)?"":(null==(y=q.banners)?void 0:y.left)||(null==(N=q.banners)?void 0:N.right)?"You have uploaded one banner image. Please upload both ".concat(ea?"top and bottom":"left and right"," banner images to continue."):"Banner images are optional and will be displayed ".concat(ea?"on the top and bottom":"on the left and right sides"," of the video when viewed in ").concat(ea?"portrait":"landscape"," mode. This helps to fill empty space on ").concat(ea?"taller":"wider"," screens.")})]})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:ea?"Top Banner":"Left Banner"}),(null==(k=q.banners)?void 0:k.left)?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:q.banners.left.url,alt:"Left Banner",className:"w-full h-32 object-contain rounded-lg"}),(0,r.jsx)("button",{onClick:()=>ey("left"),className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,r.jsxs)("div",{...eg(),className:"border-2 border-dashed rounded-lg p-6 h-32 flex flex-col items-center justify-center cursor-pointer transition-colors ".concat(ev?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"," ").concat("left"===K?"opacity-75":""),children:[(0,r.jsx)("input",{...ef()}),(0,r.jsx)("svg",{className:"h-8 w-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"left"===K?(0,r.jsx)("p",{className:"text-gray-700 text-sm",children:"Uploading banner..."}):(0,r.jsx)("p",{className:"text-gray-700 text-sm text-center",children:ev?"Drop the image here":"Drag and drop ".concat(ea?"top":"left"," banner image here, or click to select")})]})]}),(null==(C=q.banners)?void 0:C.left)&&(0,r.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Top":"Left"," Banner Scale"]}),(0,r.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:q.banners.left.scale||1,onChange:e=>eC("left",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0.1x"}),(0,r.jsxs)("span",{className:"font-medium",children:[(q.banners.left.scale||1).toFixed(1),"x"]}),(0,r.jsx)("span",{children:"3.0x"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Top":"Left"," Banner Position X"]}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:(null==(L=q.banners.left.position)?void 0:L.left)||0,onChange:e=>{let t={...q.banners};t.left&&(t.left={...t.left,position:{...t.left.position,left:parseFloat(e.target.value)}},J("banners",t))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0%"}),(0,r.jsxs)("span",{className:"font-medium",children:[((null==(F=q.banners.left.position)?void 0:F.left)||0).toFixed(0),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Top":"Left"," Banner Position Y"]}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:(null==(S=q.banners.left.position)?void 0:S.top)||0,onChange:e=>{let t={...q.banners};t.left&&(t.left={...t.left,position:{...t.left.position,top:parseFloat(e.target.value)}},J("banners",t))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0%"}),(0,r.jsxs)("span",{className:"font-medium",children:[((null==(B=q.banners.left.position)?void 0:B.top)||0).toFixed(0),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]})]}),(null==(P=q.banners)?void 0:P.left)&&(null==(A=q.banners)?void 0:A.right)&&(0,r.jsx)("div",{className:"my-6 border-t border-gray-200"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:ea?"Bottom Banner":"Right Banner"}),(null==(M=q.banners)?void 0:M.right)?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:q.banners.right.url,alt:"Right Banner",className:"w-full h-32 object-contain rounded-lg"}),(0,r.jsx)("button",{onClick:()=>ey("right"),className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,r.jsxs)("div",{...eb(),className:"border-2 border-dashed rounded-lg p-6 h-32 flex flex-col items-center justify-center cursor-pointer transition-colors ".concat(ew?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"," ").concat("right"===K?"opacity-75":""),children:[(0,r.jsx)("input",{...ej()}),(0,r.jsx)("svg",{className:"h-8 w-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"right"===K?(0,r.jsx)("p",{className:"text-gray-700 text-sm",children:"Uploading banner..."}):(0,r.jsx)("p",{className:"text-gray-700 text-sm text-center",children:ew?"Drop the image here":"Drag and drop ".concat(ea?"bottom":"right"," banner image here, or click to select")})]})]}),(null==(E=q.banners)?void 0:E.right)&&(0,r.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Bottom":"Right"," Banner Scale"]}),(0,r.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:q.banners.right.scale||1,onChange:e=>eC("right",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0.1x"}),(0,r.jsxs)("span",{className:"font-medium",children:[(q.banners.right.scale||1).toFixed(1),"x"]}),(0,r.jsx)("span",{children:"3.0x"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Bottom":"Right"," Banner Position X"]}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:(null==(T=q.banners.right.position)?void 0:T.left)||50,onChange:e=>{let t={...q.banners};t.right&&(t.right={...t.right,position:{...t.right.position,left:parseFloat(e.target.value)}},J("banners",t))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0%"}),(0,r.jsxs)("span",{className:"font-medium",children:[((null==(_=q.banners.right.position)?void 0:_.left)||50).toFixed(0),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:[ea?"Bottom":"Right"," Banner Position Y"]}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:(null==(D=q.banners.right.position)?void 0:D.top)||83.33,onChange:e=>{let t={...q.banners};t.right&&(t.right={...t.right,position:{...t.right.position,top:parseFloat(e.target.value)}},J("banners",t))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"0%"}),(0,r.jsxs)("span",{className:"font-medium",children:[((null==(W=q.banners.right.position)?void 0:W.top)||83.33).toFixed(0),"%"]}),(0,r.jsx)("span",{children:"100%"})]})]})]})]}),ee&&(0,r.jsx)("div",{className:"mt-4 bg-red-50 text-red-600 p-3 rounded-md text-center text-sm",children:ee})]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,r.jsx)("button",{onClick:Z,className:"px-6 py-2 rounded-md text-gray-700 font-medium border border-gray-300 hover:bg-gray-50",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{Q()},disabled:(null==(I=q.banners)?void 0:I.left)&&!(null==(U=q.banners)?void 0:U.right)||!(null==(H=q.banners)?void 0:H.left)&&(null==(z=q.banners)?void 0:z.right),className:"px-6 py-2 rounded-md font-medium ".concat((null==(R=q.banners)?void 0:R.left)&&!(null==(V=q.banners)?void 0:V.right)||!(null==(Y=q.banners)?void 0:Y.left)&&(null==(G=q.banners)?void 0:G.right)?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:(null==(O=q.banners)?void 0:O.left)||(null==(X=q.banners)?void 0:X.right)?"Continue":"Skip & Continue"})]})]})},f=e=>{var t,s,n,l,o,i;let{formData:d,updateFormData:c,prevStep:x}=e,[h,p]=(0,a.useState)([]),[g,f]=(0,a.useState)(""),[v,b]=(0,a.useState)("v1"),[j,w]=(0,a.useState)("PlayableAds"),[y,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[L,F]=(0,a.useState)(!1),[S,B]=(0,a.useState)(null),[P,A]=(0,a.useState)(null),[M,E]=(0,a.useState)(!1),T=(0,a.useRef)(null),_=(0,a.useRef)(null),[D,W]=(0,a.useState)(0),I=async()=>{try{if(E(!0),!d.project_id){console.log("No project_id available, skipping files info fetch"),E(!1);return}let e=await fetch(u.projectFilesInfo(d.project_id));if(!e.ok)throw Error("Failed to fetch files info: ".concat(e.status," ").concat(e.statusText));let t=await e.json();if(t.success){let e=(e=>{let t=new Map,s=e.video_files.filter(e=>{let s=e.name;return!t.has(s)&&(t.set(s,!0),!0)}),r=e.image_files.filter(e=>{let s=e.name;return!t.has(s)&&(t.set(s,!0),!0)}),a=e.other_files.filter(e=>{let s=e.name;return!t.has(s)&&(t.set(s,!0),!0)});return{...e,video_files:s,image_files:r,other_files:a}})(t);A(e)}else console.error("Error fetching files info:",t.error||"Unknown error")}catch(e){console.error("Error fetching files info:",e),A(null)}finally{E(!1)}};(0,a.useEffect)(()=>{if(d.video&&T.current&&(T.current.src=d.video.url,T.current.load()),d.project_id)try{I()}catch(e){console.error("Error in fetchFilesInfo effect:",e)}},[d.video,d.project_id]),(0,a.useEffect)(()=>{let e=e=>{"adLoaded"===e.data&&console.log("Ad loaded in iframe")};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let U=e=>{p(t=>{if("all"===e)return["all"];{let s=t.filter(e=>"all"!==e);return s.includes(e)?s.filter(t=>t!==e):[...s,e]}}),C(null)},H=e=>h.includes(e),z=async()=>{try{var e,t,s,r,a,n,l,o,i,c,x,p,f,b,w;if(B(null),N(!0),!d.video||0===h.length||""===g){B("Please select video, platform(s), and language before generating."),N(!1);return}let y=document.querySelector("video"),k="portrait";y&&y.videoWidth>y.videoHeight&&(k="landscape");let L={video_id:(null==(e=d.video)?void 0:e.id)||"",project_id:d.project_id,platforms:h,language:g,version:v,app_name:j,video_orientation:k,pause_frames:(null==(t=d.pauseFrames)?void 0:t.length)?d.pauseFrames.map(e=>{var t,s,r,a;return{time:e.time,image_id:null==(t=e.image)?void 0:t.id,position:{left:((null==(s=e.position)?void 0:s.left)||0)/100,top:((null==(r=e.position)?void 0:r.top)||0)/100},scale:e.scale||1,buttonImage_id:(null==(a=e.buttonImage)?void 0:a.id)||null,buttonPosition:e.buttonPosition?{left:(e.buttonPosition.left||0)/100,top:(e.buttonPosition.top||0)/100}:null,buttonScale:e.buttonScale||null}}):[],cta_buttons:(null==(s=d.ctaButtons)?void 0:s.length)?d.ctaButtons.map(e=>{var t,s,r;return{type:e.type||"endscreen",image_id:null==(t=e.image)?void 0:t.id,position:{left:((null==(s=e.position)?void 0:s.left)||0)/100,top:((null==(r=e.position)?void 0:r.top)||0)/100},scale:e.scale||1,time:e.startTime||0}}):[],banners:d.banners?Array.isArray(d.banners)?d.banners.length>0?d.banners.map(e=>{var t,s,r;return{type:e.type||"left",image_id:null==(t=e.image)?void 0:t.id,position:{left:((null==(s=e.position)?void 0:s.left)||0)/100,top:((null==(r=e.position)?void 0:r.top)||0)/100},scale:e.scale||1}}):[]:(null==(a=d.banners.left)||null==(r=a.image)?void 0:r.id)||(null==(l=d.banners.right)||null==(n=l.image)?void 0:n.id)?{left_image_id:(null==(i=d.banners.left)||null==(o=i.image)?void 0:o.id)||null,right_image_id:(null==(x=d.banners.right)||null==(c=x.image)?void 0:c.id)||null,left_position:(null==(p=d.banners.left)?void 0:p.position)?{left:(d.banners.left.position.left||0)/100,top:(d.banners.left.position.top||0)/100}:null,right_position:(null==(f=d.banners.right)?void 0:f.position)?{left:(d.banners.right.position.left||0)/100,top:(d.banners.right.position.top||0)/100}:null,left_scale:(null==(b=d.banners.left)?void 0:b.scale)||1,right_scale:(null==(w=d.banners.right)?void 0:w.scale)||1}:null:null},F=await fetch(u.generate,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!F.ok)throw Error("Failed to generate ad: ".concat(F.statusText));let S=await F.json();S.success?(S.preview_url&&(S.previewUrl=m(S.preview_url)),S.file_url&&(S.fileUrl=m(S.file_url)),C(S)):B("Failed to generate ad: ".concat(S.error))}catch(t){let e=t instanceof Error?t.message:"An error occurred";B("Error generating ad: ".concat(e))}finally{N(!1)}};return(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Export Ad"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:k?"Ad Preview":"Preview Area"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[k&&(0,r.jsxs)("button",{className:"flex items-center px-3 py-1.5 bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors",onClick:()=>{W(e=>e+1)},title:"Refresh Preview",children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Refresh"})]}),(0,r.jsxs)("button",{className:"flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",onClick:()=>{F(!L)},children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),L?"Portrait Mode":"Landscape Mode"]})]})]}),(0,r.jsx)("div",{className:"bg-black rounded-lg overflow-hidden transition-all duration-300 ".concat(L?"aspect-video":"aspect-[9/16] max-w-[400px] mx-auto"),children:k&&(k.previewUrl||k.preview_url)?(0,r.jsx)(a.Fragment,{children:(0,r.jsx)("iframe",{ref:_,src:k.previewUrl||m(k.preview_url),className:"w-full h-full border-0 ".concat(L?"":"transform rotate-0"),title:"Playable Ad Preview",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-pointer-lock allow-modals",style:{transform:"rotate(0deg)"}},"preview-iframe-".concat(D))}):y?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),(0,r.jsx)("p",{className:"text-white text-lg",children:"Generating your ad..."})]})}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:(0,r.jsxs)("div",{className:"text-center p-6",children:[(0,r.jsxs)("svg",{className:"mx-auto h-16 w-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),(0,r.jsx)("h3",{className:"text-white text-lg font-medium mb-2",children:"No Preview Available"}),(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:'Configure options and click "Generate Ad" to create your playable ad'})]})})}),(0,r.jsx)("div",{className:"flex justify-between mt-4",children:(0,r.jsx)("button",{onClick:x,className:"px-6 py-2 rounded-md text-gray-700 font-medium border border-gray-300 hover:bg-gray-50",children:"Back"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Ad Configuration"}),S&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"bg-red-50 p-4 rounded-md border border-red-200",children:(0,r.jsxs)("p",{className:"text-red-700 flex items-center",children:[(0,r.jsx)("svg",{className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),S]})})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Target Platforms ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)("button",{onClick:()=>U("all"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("all")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["All Platforms",H("all")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,r.jsxs)("button",{onClick:()=>U("google"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("google")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["Google Ads",H("google")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,r.jsxs)("button",{onClick:()=>U("facebook"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("facebook")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["Facebook Ads",H("facebook")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,r.jsxs)("button",{onClick:()=>U("applovin"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("applovin")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["AppLovin",H("applovin")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,r.jsxs)("button",{onClick:()=>U("moloco"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("moloco")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["Moloco",H("moloco")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,r.jsxs)("button",{onClick:()=>U("tiktok"),className:"px-4 py-2 rounded-md border transition-colors ".concat(H("tiktok")?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:["TikTok",H("tiktok")&&(0,r.jsx)("svg",{className:"h-4 w-4 inline-block ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Select one or more platforms where your ad will be displayed"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 mb-1",children:["Language ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{id:"language",value:g,onChange:e=>{f(e.target.value),C(null)},className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Language"}),(0,r.jsx)("option",{value:"en",children:"English"}),(0,r.jsx)("option",{value:"zh",children:"Chinese"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Select the language for your ad"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"appName",className:"block text-sm font-medium text-gray-700 mb-1",children:"App Name"}),(0,r.jsx)("input",{type:"text",id:"appName",value:j,onChange:e=>{w(e.target.value),C(null)},className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"PlayableAds"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Enter your application name (e.g., CandyCrush, FarmVille, TikTok)"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"version",className:"block text-sm font-medium text-gray-700 mb-1",children:"Version"}),(0,r.jsx)("input",{type:"text",id:"version",value:v,onChange:e=>{b(e.target.value),C(null)},className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"v1"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Enter the version for your ad (e.g., v1, v2, beta)"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-2",children:"Ad Content Summary"}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Media Files:"}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Video: ",(null==P||null==(t=P.video_files)?void 0:t.length)||0,(null==P?void 0:P.video_files)&&P.video_files.length>0&&" (".concat(P.human_total_video_size,")")]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Images: ",(null==P||null==(s=P.image_files)?void 0:s.length)||0,(null==P?void 0:P.image_files)&&P.image_files.length>0&&" (".concat(P.human_total_image_size,")")]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Elements:"}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Pause Frames: ",(null==(n=d.pauseFrames)?void 0:n.length)||0]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["CTA Buttons: ",(null==(l=d.ctaButtons)?void 0:l.length)||0]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Banners: ",Array.isArray(d.banners)?d.banners.length:+(null!=(o=d.banners)&&!!o.left)+ +(null!=(i=d.banners)&&!!i.right)]})]})]}),P&&(0,r.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium",children:"Estimated HTML Size:"})," ",P.human_estimated_html_size]})}),M&&(0,r.jsxs)("div",{className:"text-center py-2",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"Loading file info..."})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("button",{onClick:z,disabled:y||!d.video||0===h.length||""===g,className:"w-full py-3 rounded-md font-medium ".concat(y||!d.video||0===h.length||""===g?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:y?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):(0,r.jsxs)(r.Fragment,{children:["Generate ",1===h.length&&"all"===h[0]?"All Ads":h.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", ")]})}),k&&(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-md border border-green-200",children:(0,r.jsxs)("p",{className:"text-green-700 flex items-center",children:[(0,r.jsx)("svg",{className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Ad generated successfully for ",1===h.length&&"all"===h[0]?"All Platforms":h.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", "),"! You can preview it in the left panel."]})}),(0,r.jsxs)("button",{onClick:()=>{try{if((null==k?void 0:k.file_url)&&k.file_url.includes(".zip")){let e=k.file_url.split("/").pop(),t=u.download(d.project_id,e);window.open(t,"_blank")}else{let e=(null==k?void 0:k.file_url)||"";if((h.includes("google")||h.includes("moloco")||h.includes("tiktok"))&&1===h.length){let e=d.project_id,t=encodeURIComponent(j),s=encodeURIComponent(v),r=encodeURIComponent(g||"en"),a=h.includes("google")?"google":h.includes("moloco")?"moloco":"tiktok",n="".concat(t,"-").concat(a,"-").concat(r,"-").concat(s,".zip"),l=u.download(e,n);window.open(l,"_blank")}else{let t=u.downloadFile(e);window.open(t,"_blank")}}}catch(e){B("Failed to download file. Please try again.")}},className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,r.jsx)("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download ",1===h.length&&"all"===h[0]?"All Platforms":h.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", ")," Ad (",j,")"]})]})]})]})]})]})};var v=s(4094),b=s(8021);function j(){let{t:e}=(0,v.o)(),[t,s]=(0,a.useState)(1),[n,i]=(0,a.useState)({video:null,pauseFrames:[],ctaButtons:[],banners:{left:null,right:null},platform:"google"}),d=[{id:1,title:e("uploadVideo")},{id:2,title:e("addPauseFrames")},{id:3,title:e("addCTAButtons")},{id:4,title:e("addBannersOptional")},{id:5,title:e("export")}],c=(e,t)=>{i(s=>({...s,[e]:t}))},u=()=>{t<d.length&&s(t+1)},m=()=>{t>1&&s(t-1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{},"create-page-navbar"),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)(l(),{href:"/",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),e("backToHome")]})}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("createPlayableAd")}),(0,r.jsx)(o,{steps:d,currentStep:t})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(()=>{switch(t){case 1:return(0,r.jsx)(x,{formData:n,updateFormData:c,nextStep:u});case 2:return(0,r.jsx)(h,{formData:n,updateFormData:c,nextStep:u,prevStep:m});case 3:return(0,r.jsx)(p,{formData:n,updateFormData:c,nextStep:u,prevStep:m});case 4:return(0,r.jsx)(g,{formData:n,updateFormData:c,nextStep:u,prevStep:m});case 5:return(0,r.jsx)(f,{formData:n,updateFormData:c,prevStep:m});default:return null}})()})]})]})}},8021:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(5155),a=s(2115),n=s(2619),l=s.n(n),o=s(4094);let i={zh:{name:"中文",flag:"\uD83C\uDDE8\uD83C\uDDF3",label:"中文"},en:{name:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8",label:"English"}};function d(){let{locale:e,setLocale:t}=(0,o.o)(),[s,n]=(0,a.useState)(!1),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{function e(e){l.current&&!l.current.contains(e.target)&&n(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.jsxs)("div",{className:"relative",ref:l,children:[(0,r.jsxs)("button",{onClick:()=>{n(!s)},className:"flex items-center space-x-2 py-2 px-3 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50","aria-label":"选择语言",children:[(0,r.jsx)("span",{className:"text-lg",children:i[e].flag}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:i[e].name}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform duration-200 ".concat(s?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-gray-200 z-50 animate-fadeIn",children:(0,r.jsx)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:Object.entries(i).map(s=>{let[a,{name:l,flag:o}]=s;return(0,r.jsxs)("button",{onClick:()=>{t(a),n(!1)},className:"flex items-center w-full px-4 py-2 text-sm ".concat(e===a?"bg-gray-100 text-gray-900 font-medium":"text-gray-700 hover:bg-gray-50"),role:"menuitem",children:[(0,r.jsx)("span",{className:"text-lg mr-3",children:o}),(0,r.jsx)("span",{children:l}),e===a&&(0,r.jsx)("svg",{className:"ml-auto w-4 h-4 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},a)})})})]})}function c(){let{t:e}=(0,o.o)(),[t,s]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{i(!0);let e=()=>{window.scrollY>10?s(!0):s(!1)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),(0,r.jsx)("header",{className:"sticky top-0 z-50 w-full transition-all duration-300 ".concat(t?"bg-white/95 backdrop-blur-md shadow-sm py-3":"bg-white py-4"),children:(0,r.jsxs)("div",{className:"container mx-auto px-4 md:px-6 flex justify-between items-center",children:[(0,r.jsxs)(l(),{href:"/",className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M12 2L2 7L12 12L22 7L12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M2 17L12 22L22 17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M2 12L12 17L22 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,r.jsx)("span",{className:"text-xl font-bold text-gray-900",children:e("appName")})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(d,{})})]})})}}},e=>{e.O(0,[619,54,441,255,358],()=>e(e.s=5111)),_N_E=e.O()}]);